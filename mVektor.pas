unit mVektor;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ExtCtrls;

type
  TAnalytischeGeometrie = class(TForm)
    edAx: TLabeledEdit;
    edAy: TEdit;
    edAz: TEdit;
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    edBx: TLabeledEdit;
    edBy: TEdit;
    edBz: TEdit;
    Label6: TLabel;
    Label7: TLabel;
    Label8: TLabel;
    Label9: TLabel;
    edCx: TLabeledEdit;
    edCy: TEdit;
    edCz: TEdit;
    Label10: TLabel;
    Label11: TLabel;
    Label12: TLabel;
    Label13: TLabel;
    btPMF: TButton;
    Label5: TLabel;
    Label14: TLabel;
    edSVX: TEdit;
    edSVY: TEdit;
    edSVZ: TEdit;
    Label15: TLabel;
    Shape1: TShape;
    Label16: TLabel;
    Label18: TLabel;
    Label19: TLabel;
    Label20: TLabel;
    Label21: TLabel;
    ed1RVX: TEdit;
    ed1RVY: TEdit;
    ed1RVZ: TEdit;
    Label22: TLabel;
    Label23: TLabel;
    Label24: TLabel;
    Label25: TLabel;
    ed2RVX: TEdit;
    ed2RVY: TEdit;
    ed2RVZ: TEdit;
    btNV: TButton;
    Label26: TLabel;
    Label27: TLabel;
    edN1: TEdit;
    edN2: TEdit;
    edN3: TEdit;
    Label28: TLabel;
    Shape3: TShape;
    Label29: TLabel;
    btPNF: TButton;
    Label17: TLabel;
    Label30: TLabel;
    Label31: TLabel;
    edNV1: TEdit;
    edNV2: TEdit;
    edNV3: TEdit;
    Label33: TLabel;
    Label34: TLabel;
    Label35: TLabel;
    Label36: TLabel;
    Label37: TLabel;
    edA1: TEdit;
    edA2: TEdit;
    edA3: TEdit;
    Label32: TLabel;
    btNF: TButton;
    edNFX: TEdit;
    edNFY: TEdit;
    edNFZ: TEdit;
    edNFZahl: TEdit;
    Label38: TLabel;
    Label39: TLabel;
    Label40: TLabel;
    btAAF: TButton;
    Label42: TLabel;
    Label43: TLabel;
    Label44: TLabel;
    Shape2: TShape;
    Shape4: TShape;
    Shape5: TShape;
    Label45: TLabel;
    Label46: TLabel;
    edAAFX: TEdit;
    edAAFY: TEdit;
    edAAFZ: TEdit;
    Label47: TLabel;
    btNEV: TButton;
    Label48: TLabel;
    Label49: TLabel;
    Label50: TLabel;
    Shape6: TShape;
    Label51: TLabel;
    edNEVX: TEdit;
    edNEVY: TEdit;
    edNEVZ: TEdit;
    Label52: TLabel;
    btHNF: TButton;
    Label53: TLabel;
    Label54: TLabel;
    Label55: TLabel;
    Label56: TLabel;
    Label57: TLabel;
    Label58: TLabel;
    Label59: TLabel;
    Label60: TLabel;
    Label61: TLabel;
    edNEV1: TEdit;
    edNEV2: TEdit;
    edNEV3: TEdit;
    edA_X: TEdit;
    edA_Y: TEdit;
    edA_Z: TEdit;
    Label62: TLabel;
    edD: TEdit;
    Label63: TLabel;
    Shape7: TShape;
    Shape8: TShape;
    Label64: TLabel;
    Label65: TLabel;
    Label66: TLabel;
    Label67: TLabel;
    btClear: TButton;
    Label41: TLabel;
    Label68: TLabel;
    Label69: TLabel;
    edSX1: TEdit;
    edSX2: TEdit;
    edSX3: TEdit;
    Label70: TLabel;
    btSpurpunkte: TButton;
    Label71: TLabel;
    Label72: TLabel;
    edSY1: TEdit;
    edSY2: TEdit;
    edSY3: TEdit;
    Label73: TLabel;
    Label74: TLabel;
    Label75: TLabel;
    edSZ1: TEdit;
    edSZ2: TEdit;
    edSZ3: TEdit;
    Label76: TLabel;
    btSpurgeraden: TButton;
    Label77: TLabel;
    Label78: TLabel;
    Label79: TLabel;
    Label80: TLabel;
    Label81: TLabel;
    Label82: TLabel;
    edSG1X1: TEdit;
    edSG1Y1: TEdit;
    edSG1Z1: TEdit;
    edSG1X2: TEdit;
    edSG1Y2: TEdit;
    edSG1Z2: TEdit;
    Label83: TLabel;
    Label84: TLabel;
    Label85: TLabel;
    Label86: TLabel;
    Label87: TLabel;
    Label88: TLabel;
    edSG2X1: TEdit;
    edSG2Y1: TEdit;
    edSG2Z1: TEdit;
    edSG2X2: TEdit;
    edSG2Y2: TEdit;
    edSG2Z2: TEdit;
    Label89: TLabel;
    Label90: TLabel;
    Label91: TLabel;
    Label92: TLabel;
    Label93: TLabel;
    Label94: TLabel;
    edSG3X1: TEdit;
    edSG3Y1: TEdit;
    edSG3Z1: TEdit;
    edSG3X2: TEdit;
    edSG3Y2: TEdit;
    edSG3Z2: TEdit;
    Label95: TLabel;
    Shape9: TShape;
    Label96: TLabel;
    Label97: TLabel;
    Shape10: TShape;
    Label98: TLabel;
    Label99: TLabel;
    Shape11: TShape;
    Label100: TLabel;
    btLaenge: TButton;
    Label101: TLabel;
    Shape12: TShape;
    Label102: TLabel;
    Shape13: TShape;
    Shape14: TShape;
    edLaenge1: TEdit;
    Label103: TLabel;
    Shape15: TShape;
    Label104: TLabel;
    Shape16: TShape;
    Shape17: TShape;
    edLaenge2: TEdit;
    Label105: TLabel;
    Shape18: TShape;
    Label106: TLabel;
    Shape19: TShape;
    Shape20: TShape;
    edLaenge3: TEdit;
    procedure btPMFClick(Sender: TObject);
    procedure btNVClick(Sender: TObject);
    procedure btPNFClick(Sender: TObject);
    procedure btNFClick(Sender: TObject);
    procedure btAAFClick(Sender: TObject);
    procedure btNEVClick(Sender: TObject);
    procedure btHNFClick(Sender: TObject);
    procedure btClearClick(Sender: TObject);
    procedure onclose(Sender: TObject; var Action: TCloseAction);
    procedure btAnal2Click(Sender: TObject);
    procedure btSpurpunkteClick(Sender: TObject);
    procedure btSpurgeradenClick(Sender: TObject);
    procedure btLaengeClick(Sender: TObject);
  private
    { Private declarations }
    Ax, Ay, Az, Bx, By, Bz, Cx, Cy, Cz, ux, uy, uz, vx, vy, vz, A1, A2, A3, N1, N2, N3: real;
  public
    { Public declarations }
  end;

var
  AnalytischeGeometrie: TAnalytischeGeometrie;

implementation

uses mMatheManager;

{$R *.dfm}

procedure TAnalytischeGeometrie.btPMFClick(Sender: TObject);
begin
   Ax := StrToFloat(edAx.Text);
   Ay := StrToFloat(edAy.Text);
   Az := StrToFloat(edAz.Text);
   Bx := StrToFloat(edBx.Text);
   By := StrToFloat(edBy.Text);
   Bz := StrToFloat(edBz.Text);
   Cx := StrToFloat(edCx.Text);
   Cy := StrToFloat(edCy.Text);
   Cz := StrToFloat(edCz.Text);
   edSVX.Text := edAx.Text;
   edSVY.Text := edAy.Text;
   edSVZ.Text := edAz.Text;
   ux := -Ax+Bx;
   ed1RVX.Text := FloatToStr(ux);
   uy := -Ay+By;
   ed1RVY.Text := FloatToStr(uy);
   uz := -Az+Bz;
   ed1RVZ.Text := FloatToStr(uz);
   vx := -Ax+Cx;
   ed2RVX.Text := FloatToStr(vx);
   vy := -Ay+Cy;
   ed2RVY.Text := FloatToStr(vy);
   vz := -Az+Cz;
   ed2RVZ.Text := FloatToStr(vz);
end;

procedure TAnalytischeGeometrie.btNVClick(Sender: TObject);
begin
   edN1.Text := FloatToStr(uy*vz-uz*vy);
   N1 := uy*vz-uz*vy;
   edN2.Text := FloatToStr((ux*vz-uz*vx)*-1);
   N2 := (ux*vz-uz*vx)*-1;
   edN3.Text := FloatToStr(ux*vy-uy*vx);
   N3 := ux*vy-uy*vx;
end;

procedure TAnalytischeGeometrie.btPNFClick(Sender: TObject);
begin
   edNV1.Text := edN1.Text;
   edNV2.Text := edN2.Text;
   edNV3.Text := edN3.Text;
   A1 := StrToFloat(edSVX.Text);
   edA1.Text := edSVX.Text;
   A2 := StrToFloat(edSVY.Text);
   edA2.Text := edSVY.Text;
   A3 := StrToFloat(edSVZ.Text);
   edA3.Text := edSVZ.Text;
end;

procedure TAnalytischeGeometrie.btNFClick(Sender: TObject);
var temp: real;
begin
   temp := 0;
   edNFX.Text := edNV1.Text;
   edNFY.Text := edNV2.Text;
   edNFZ.Text := edNV3.Text;
   if A1 <> 0 then
   temp := temp + (StrToFloat(edNFX.Text)*A1);
   if A2 <> 0 then
   temp := temp + (StrToFloat(edNFY.Text)*A2);
   if A3 <> 0 then
   temp := temp + (StrToFloat(edNFZ.Text)*A3);
   edNFZahl.Text := FloatToStr(temp);
end;

procedure TAnalytischeGeometrie.btAAFClick(Sender: TObject);
begin
   edAAFX.Text := FloatToStr(StrToFloat(edNFZahl.Text)/StrToFloat(edNFX.Text));
   edAAFY.Text := FloatToStr(StrToFloat(edNFZahl.Text)/StrToFloat(edNFY.Text));
   edAAFZ.Text := FloatToStr(StrToFloat(edNFZahl.Text)/StrToFloat(edNFZ.Text));
   Label66.Caption := FloatToStr(StrToFloat(edNFZahl.Text)/StrToFloat(edNFZahl.Text));
end;

procedure TAnalytischeGeometrie.btNEVClick(Sender: TObject);
var temp: real;
begin
   temp := 1/(SQRT(N1*N1+N2*N2+N3*N3));
   edNEVX.Text := FloatToStr(N1*temp);
   edNEVY.Text := FloatToStr(N2*temp);
   edNEVZ.Text := FloatToStr(N3*temp);
end;

procedure TAnalytischeGeometrie.btHNFClick(Sender: TObject);
var d: real;
begin
   edNEV1.Text := edNEVX.Text;
   edNEV2.Text := edNEVY.Text;
   edNEV3.Text := edNEVZ.Text;
   edA_X.Text := edA1.Text;
   edA_Y.Text := edA2.Text;
   edA_Z.Text := edA3.Text;
   d := (StrToFloat(edNEVX.Text)*A1)+(StrToFloat(edNEVY.Text)*A2)+(StrToFloat(edNEVZ.Text)*A3);
   if d < 0 then d := d*(-1);
   edD.Text := FloatToStr(d);
end;

procedure TAnalytischeGeometrie.btClearClick(Sender: TObject);
label 1;
begin
   case Application.MessageBox('Punkte auch löschen?', 'Frage', 35) of
   IDYES:
   begin
      edAx.Clear;
      edAy.Clear;
      edAz.Clear;
      edBx.Clear;
      edBy.Clear;
      edBz.Clear;
      edCx.Clear;
      edCy.Clear;
      edCz.Clear;
      goto 1;
   end;
   IDNO:
1: begin
      edSVX.Clear;
      edSVY.Clear;
      edSVZ.Clear;
      ed1RVX.Clear;
      ed1RVY.Clear;
      ed1RVZ.Clear;
      ed2RVX.Clear;
      ed2RVY.Clear;
      ed2RVZ.Clear;
      edN1.Clear;
      edN2.Clear;
      edN3.Clear;
      edNV1.Clear;
      edNV2.Clear;
      edNV3.Clear;
      edA1.Clear;
      edA2.Clear;
      edA3.Clear;
      edNFX.Clear;
      edNFY.Clear;
      edNFZ.Clear;
      edNFZahl.Clear;
      edAAFX.Clear;
      edAAFY.Clear;
      edAAFZ.Clear;
      Label66.Caption := '';
      edNEVX.Clear;
      edNEVY.Clear;
      edNEVZ.Clear;
      edNEV1.Clear;
      edNEV2.Clear;
      edNEV3.Clear;
      edA_X.Clear;
      edA_Y.Clear;
      edA_Z.Clear;
      edD.Clear;
      edSX1.Clear;
      edSY2.Clear;
      edSZ3.Clear;
      edSG1X1.Clear;
      edSG1Y1.Clear;
      edSG1Z1.Clear;
      edSG1X2.Clear;
      edSG1Y2.Clear;
      edSG1Z2.Clear;
      edSG2X1.Clear;
      edSG2Y1.Clear;
      edSG2Z1.Clear;
      edSG2X2.Clear;
      edSG2Y2.Clear;
      edSG2Z2.Clear;
      edSG3X1.Clear;
      edSG3Y1.Clear;
      edSG3Z1.Clear;
      edSG3X2.Clear;
      edSG3Y2.Clear;
      edSG3Z2.Clear;
      edLaenge1.Clear;
   end;
   end;
end;

procedure TAnalytischeGeometrie.onclose(Sender: TObject; var Action: TCloseAction);
begin
   MatheManager.StatusBar1.SimpleText := 'Bereit.';
end;

procedure TAnalytischeGeometrie.btAnal2Click(Sender: TObject);
begin
   AnalytischeGeometrie.Height := AnalytischeGeometrie.Height*2;
end;

procedure TAnalytischeGeometrie.btSpurpunkteClick(Sender: TObject);
begin
   edSX1.Text := edAAFX.Text;
   edSY2.Text := edAAFY.Text;
   edSZ3.Text := edAAFZ.Text;
end;

procedure TAnalytischeGeometrie.btSpurgeradenClick(Sender: TObject);
begin
   edSG1X1.Text := edSX1.Text;
   edSG1Y1.Text := edSX2.Text;
   edSG1Z1.Text := edSX3.Text;
   edSG1X2.Text := FloatToStr(-StrToFloat(edSX1.Text)+StrToFloat(edSY1.Text));
   edSG1Y2.Text := FloatToStr(-StrToFloat(edSX2.Text)+StrToFloat(edSY2.Text));
   edSG1Z2.Text := FloatToStr(-StrToFloat(edSX3.Text)+StrToFloat(edSY3.Text));
   edSG2X1.Text := edSX1.Text;
   edSG2Y1.Text := edSX2.Text;
   edSG2Z1.Text := edSX3.Text;
   edSG2X2.Text := FloatToStr(-StrToFloat(edSX1.Text)+StrToFloat(edSZ1.Text));
   edSG2Y2.Text := FloatToStr(-StrToFloat(edSX2.Text)+StrToFloat(edSZ2.Text));
   edSG2Z2.Text := FloatToStr(-StrToFloat(edSX3.Text)+StrToFloat(edSZ3.Text));
   edSG3X1.Text := edSY1.Text;
   edSG3Y1.Text := edSY2.Text;
   edSG3Z1.Text := edSY3.Text;
   edSG3X2.Text := FloatToStr(-StrToFloat(edSY1.Text)+StrToFloat(edSZ1.Text));
   edSG3Y2.Text := FloatToStr(-StrToFloat(edSY2.Text)+StrToFloat(edSZ2.Text));
   edSG3Z2.Text := FloatToStr(-StrToFloat(edSY3.Text)+StrToFloat(edSZ3.Text));
end;

procedure TAnalytischeGeometrie.btLaengeClick(Sender: TObject);
begin
   edLaenge1.Text := FloatToStr(SQRT(SQR(StrToFloat(edSG1X2.Text))+SQR(StrToFloat(edSG1Y2.Text))+SQR(StrToFloat(edSG1Z2.Text))));
   edLaenge2.Text := FloatToStr(SQRT(SQR(StrToFloat(edSG2X2.Text))+SQR(StrToFloat(edSG2Y2.Text))+SQR(StrToFloat(edSG2Z2.Text))));
   edLaenge3.Text := FloatToStr(SQRT(SQR(StrToFloat(edSG3X2.Text))+SQR(StrToFloat(edSG3Y2.Text))+SQR(StrToFloat(edSG3Z2.Text))));
end;

end.
